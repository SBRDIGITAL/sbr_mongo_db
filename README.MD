## Методичка по запуску и настройке MongoDB с использованием Docker

### Шаг 1: Установка Docker и Docker Compose

1. **Скачайте и установите Docker Desktop**:
   - Перейдите на [официальный сайт Docker](https://www.docker.com/products/docker-desktop) и скачайте установщик для Windows.
   - Установите Docker Desktop, следуя инструкциям на экране.

2. **Проверьте установку**:
   - Откройте командную строку (CMD) или PowerShell и выполните команды:
     ```bash
     docker --version
     docker-compose --version
     ```

### Шаг 2: Клонирование репозитория

1. **Склонируйте репозиторий**:
   - Используйте следующую команду для клонирования репозитория:
   ```bash
   git clone https://github.com/SBRDIGITAL/sbr_mongo_db.git
   ```

2. **Перейдите в директорию `mondocker`**:
   ```bash
   cd path\to\клонированный_репозиторий\mondocker
   ```

### Шаг 3: Запуск контейнеров

1. **Запустите Docker Compose**:
   - В командной строке выполните следующую команду для запуска контейнеров:
   ```bash
   docker-compose up --build --force-recreate
   ```

2. **Проверьте, что контейнеры запущены**:
   - Выполните команду:
   ```bash
   docker ps
   ```
   или
   ```bash
   docker-compose ps
   ```

### Шаг 4: Подключение к MongoDB

1. **Подключитесь к первому экземпляру MongoDB**:
   - Выполните команду:
   ```bash
   docker exec -it mongo1 mongosh
   ```

### Шаг 5: Инициализация репликационного набора

1. **Инициализируйте репликационный набор**:
   - Введите следующую команду в `mongosh`:
   ```javascript
   rs.initiate({
     _id: "rs0",
     members: [
       { _id: 0, host: "mongo1:27017" },
       { _id: 1, host: "mongo2:27017" },
       { _id: 2, host: "mongo3:27017" }
     ]
   });
   ```

2. **Проверьте статус репликационного набора**:
   - Введите команду:
   ```javascript
   rs.status();
   ```

### Шаг 6: Протестируйте использование MongoDB
1. **Перейдите в корень проекта**
1. **Создайте и активируйте виртуальное окружение удобным для вас способом**
2. **Установите зависимости из `requirements.txt`**
3. **Запустите файл `main.py`**
4. **В консоли должно появиться что-то похожее на:**
```bash
   Синхронно:
   Удалено 0 документ(ов).
   Удалено 1 документ(ов).
   Вставлен документ с id: 674c751123641122fd84ae5a
   Вставлен документ с id: 674c751123641122fd84ae5b
   Найден документ: {'_id': ObjectId('674c751123641122fd84ae5a'), 'id': 0, 'name': 'Alice'}
   Найдено документов: 1
   doc={'_id': ObjectId('674c751123641122fd84ae5a'), 'id': 0, 'name': 'Alice'}
   Изменено 1 документ(ов).
   Найден документ: {'_id': ObjectId('674c751123641122fd84ae5a'), 'id': 0, 'name': 'Alice', 'age': 31}
   Найден документ: {'_id': ObjectId('674c751123641122fd84ae5b'), 'id': 1, 'name': 'Bob'}
   Удалено 1 документ(ов).
   Документ не найден.
   Изменено 0 документ(ов).

   Асинхронно:
   Удалено 0 документ(ов).
   Удалено 1 документ(ов).
   Вставлен документ с id: 674c751123641122fd84ae5d
   Вставлен документ с id: 674c751123641122fd84ae5e
   Найден документ: {'_id': ObjectId('674c751123641122fd84ae5d'), 'id': 0, 'name': 'Alice'}
   Найдено документов: 1
   doc={'_id': ObjectId('674c751123641122fd84ae5d'), 'id': 0, 'name': 'Alice'}
   Изменено 1 документ(ов).
   Найден документ: {'_id': ObjectId('674c751123641122fd84ae5d'), 'id': 0, 'name': 'Alice', 'age': 31}
   Найден документ: {'_id': ObjectId('674c751123641122fd84ae5e'), 'id': 1, 'name': 'Bob'}
   Удалено 1 документ(ов).
   Документ не найден.
   Изменено 0 документ(ов).
```